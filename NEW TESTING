import urllib
import json
import mysql.connector
import time


# Connect to database
# You may need to edit the connect function based on your local settings.
def connect_to_sql():
    conn = mysql.connector.connect(user='root', password='',
                                  host='127.0.0.1',
                                  database='test1')
    return conn

# Create the table structure
def create_tables(cursor, table):
    cursor.execute('''CREATE TABLE IF NOT EXISTS Movies (id INT PRIMARY KEY auto_increment,
                            Movie_Title varchar(10), IMDB_Ratings varchar(100), Genres varchar(36),
                            Release_Date DATE, Cast varchar(1000)); ''')
    return

# Query the database.
def query_sql(cursor, query):
    cursor.execute(query)
    return cursor

def main():
    # Connect to SQL
    conn = connect_to_sql()
    cursor = conn.cursor()
    create_tables(cursor, "table")
    # Load text file and store arguments into dictionary
    arg_dict = 0
    while (1):
        conn.commit()
        time.sleep(3600)
        # Sleep for 1h

if __name__ == '__main__':
    main()

def fetch_new_jobs(arg_dict):
    query = "https://gist.github.com/tiangechen/b68782efa49a16edaf07dc2cdaa855ea"
    jsonpage = 0
    try:
        contents = urllib.request.urlopen(query)
        response = contents.read()
        jsonpage = json.loads(response)
    except:
        pass
    return jsonpage

